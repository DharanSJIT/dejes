<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Campus Platform</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="spinner"></div>
        <p>Loading Virtual Campus...</p>
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="screen" style="display: none;">
        <div class="login-container">
            <div class="login-card">
                <h1>Virtual Campus Platform</h1>
                <p>Connect, Learn, and Collaborate with your peers</p>
                <button id="google-login-btn" class="login-btn">
                    <i data-feather="user"></i>
                    Sign in with Google
                </button>
            </div>
        </div>
    </div>
    <!-- Main App Screen -->
    <div id="main-app" class="screen" style="display: none;">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-brand">
                <h2>Virtual Campus</h2>
            </div>
            <div class="nav-menu">
                <button class="nav-btn active" data-view="dashboard">
                    <i data-feather="home"></i>
                    Dashboard
                </button>
                <button class="nav-btn" data-view="study-rooms">
                    <i data-feather="video"></i>
                    Study Rooms
                </button>
                <button class="nav-btn" data-view="matching">
                    <i data-feather="users"></i>
                    Find Study Buddy
                </button>
                <button class="nav-btn" data-view="clubs">
                    <i data-feather="calendar"></i>
                    Clubs & Events
                </button>
                <button class="nav-btn" data-view="tutoring">
                    <i data-feather="book"></i>
                    Tutoring
                </button>
            </div>
            <div class="nav-profile">
                <img id="user-avatar" src="" alt="User Avatar" class="avatar">
                <span id="user-name"></span>
                <button id="logout-btn" class="logout-btn">
                    <i data-feather="log-out"></i>
                </button>
            </div>
        </nav>
        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Dashboard View -->
            <div id="dashboard-view" class="view active">
                <div class="dashboard-header">
                    <h1>Welcome back, <span id="dashboard-user-name"></span>!</h1>
                    <p>Here's what's happening in your virtual campus today</p>
                </div>
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3><i data-feather="video"></i> Active Study Rooms</h3>
                        <div id="active-rooms-list" class="dashboard-list">
                            <!-- Populated by JavaScript -->
                        </div>
                        <button class="card-action-btn" onclick="showView('study-rooms')">View All Rooms</button>
                    </div>

                    <div class="dashboard-card">
                        <h3><i data-feather="calendar"></i> Upcoming Events</h3>
                        <div id="upcoming-events-list" class="dashboard-list">
                            <!-- Populated by JavaScript -->
                        </div>
                        <button class="card-action-btn" onclick="showView('clubs')">View All Events</button>
                    </div>
                    <div class="dashboard-card">
                        <h3><i data-feather="users"></i> Recommended Study Buddies</h3>
                        <div id="recommended-peers-list" class="dashboard-list">
                            <!-- Populated by JavaScript -->
                        </div>
                        <button class="card-action-btn" onclick="showView('matching')">Find More Buddies</button>
                    </div>

                    <div class="dashboard-card">
                        <h3><i data-feather="book"></i> Your Tutoring Sessions</h3>
                        <div id="tutoring-sessions-list" class="dashboard-list">
                            <!-- Populated by JavaScript -->
                        </div>
                        <button class="card-action-btn" onclick="showView('tutoring')">Manage Sessions</button>
                    </div>
                </div>
            </div>

            <!-- Study Rooms View -->
            <div id="study-rooms-view" class="view">
                <div class="view-header">
                    <h1>Study Rooms</h1>
                    <button id="create-room-btn" class="primary-btn">
                        <i data-feather="plus"></i>
                        Create Room
                    </button>
                </div>

                <div class="rooms-grid" id="rooms-grid">
                    <!-- Populated by JavaScript -->
                </div>

                <!-- Create Room Modal -->
                <div id="create-room-modal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>Create Study Room</h2>
                            <button class="close-btn" onclick="closeModal('create-room-modal')">
                                <i data-feather="x"></i>
                            </button>
                        </div>
                        <form id="create-room-form">
                            <div class="form-group">
                                <label for="room-name">Room Name</label>
                                <input type="text" id="room-name" required>
                            </div>
                            <div class="form-group">
                                <label for="room-subject">Subject</label>
                                <select id="room-subject" required>
                                    <option value="">Select Subject</option>
                                    <option value="mathematics">Mathematics</option>
                                    <option value="science">Science</option>
                                    <option value="english">English</option>
                                    <option value="history">History</option>
                                    <option value="computer-science">Computer Science</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="room-description">Description</label>
                                <textarea id="room-description" rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="room-capacity">Max Participants</label>
                                <input type="number" id="room-capacity" min="2" max="10" value="6">
                            </div>
                            <div class="form-actions">
                                <button type="button" onclick="closeModal('create-room-modal')">Cancel</button>
                                <button type="submit" class="primary-btn">Create Room</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Video Chat Modal -->
                <div id="video-chat-modal" class="modal fullscreen-modal">
                    <div class="video-chat-container">
                        <div class="video-header">
                            <h3 id="chat-room-name"></h3>
                            <div class="video-controls">
                                <button id="toggle-video-btn" class="control-btn">
                                    <i data-feather="video"></i>
                                </button>
                                <button id="toggle-audio-btn" class="control-btn">
                                    <i data-feather="mic"></i>
                                </button>
                                <button id="leave-room-btn" class="control-btn danger">
                                    <i data-feather="phone-off"></i>
                                </button>
                            </div>
                        </div>
                        <div class="video-grid" id="video-grid">
                            <video id="local-video" autoplay muted playsinline></video>
                        </div>
                        <div class="chat-sidebar">
                            <div class="chat-messages" id="chat-messages"></div>
                            <div class="chat-input">
                                <input type="text" id="message-input" placeholder="Type a message...">
                                <button id="send-message-btn">
                                    <i data-feather="send"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Study Group Matching View -->
            <div id="matching-view" class="view">
                <div class="view-header">
                    <h1>Find Study Buddies</h1>
                    <button id="update-preferences-btn" class="primary-btn">
                        <i data-feather="settings"></i>
                        Update Preferences
                    </button>
                </div>

                <div class="matching-content">
                    <div class="preferences-card">
                        <h3>Your Study Preferences</h3>
                        <div id="user-preferences">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <div class="matches-grid" id="matches-grid">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <!-- Preferences Modal -->
                <div id="preferences-modal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>Study Preferences</h2>
                            <button class="close-btn" onclick="closeModal('preferences-modal')">
                                <i data-feather="x"></i>
                            </button>
                        </div>
                        <form id="preferences-form">
                            <div class="form-group">
                                <label>Subjects of Interest</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" value="mathematics"> Mathematics</label>
                                    <label><input type="checkbox" value="science"> Science</label>
                                    <label><input type="checkbox" value="english"> English</label>
                                    <label><input type="checkbox" value="history"> History</label>
                                    <label><input type="checkbox" value="computer-science"> Computer Science</label>
                                    <label><input type="checkbox" value="other"> Other</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Study Times</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" value="morning"> Morning (6AM-12PM)</label>
                                    <label><input type="checkbox" value="afternoon"> Afternoon (12PM-6PM)</label>
                                    <label><input type="checkbox" value="evening"> Evening (6PM-10PM)</label>
                                    <label><input type="checkbox" value="late-night"> Late Night (10PM-2AM)</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="study-style">Study Style</label>
                                <select id="study-style">
                                    <option value="collaborative">Collaborative</option>
                                    <option value="focused">Focused/Silent</option>
                                    <option value="discussion">Discussion-based</option>
                                    <option value="mixed">Mixed</option>
                                </select>
                            </div>
                            <div class="form-actions">
                                <button type="button" onclick="closeModal('preferences-modal')">Cancel</button>
                                <button type="submit" class="primary-btn">Save Preferences</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Clubs & Events View -->
            <div id="clubs-view" class="view">
                <div class="view-header">
                    <h1>Clubs & Events</h1>
                    <div class="view-actions">
                        <button id="create-club-btn" class="primary-btn">
                            <i data-feather="plus"></i>
                            Create Club
                        </button>
                        <button id="create-event-btn" class="secondary-btn">
                            <i data-feather="calendar-plus"></i>
                            Create Event
                        </button>
                    </div>
                </div>

                <div class="clubs-tabs">
                    <button class="tab-btn active" data-tab="my-clubs">My Clubs</button>
                    <button class="tab-btn" data-tab="all-clubs">All Clubs</button>
                    <button class="tab-btn" data-tab="events">Upcoming Events</button>
                </div>

                <div class="clubs-content">
                    <div id="my-clubs-tab" class="tab-content active">
                        <div id="my-clubs-grid" class="clubs-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <div id="all-clubs-tab" class="tab-content">
                        <div id="all-clubs-grid" class="clubs-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <div id="events-tab" class="tab-content">
                        <div id="events-list" class="events-list">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Create Club Modal -->
                <div id="create-club-modal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>Create Club</h2>
                            <button class="close-btn" onclick="closeModal('create-club-modal')">
                                <i data-feather="x"></i>
                            </button>
                        </div>
                        <form id="create-club-form">
                            <div class="form-group">
                                <label for="club-name">Club Name</label>
                                <input type="text" id="club-name" required>
                            </div>
                            <div class="form-group">
                                <label for="club-description">Description</label>
                                <textarea id="club-description" rows="4" required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="club-category">Category</label>
                                <select id="club-category" required>
                                    <option value="">Select Category</option>
                                    <option value="academic">Academic</option>
                                    <option value="hobby">Hobby</option>
                                    <option value="professional">Professional</option>
                                    <option value="social">Social</option>
                                    <option value="sports">Sports</option>
                                </select>
                            </div>
                            <div class="form-actions">
                                <button type="button" onclick="closeModal('create-club-modal')">Cancel</button>
                                <button type="submit" class="primary-btn">Create Club</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Create Event Modal -->
                <div id="create-event-modal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>Create Event</h2>
                            <button class="close-btn" onclick="closeModal('create-event-modal')">
                                <i data-feather="x"></i>
                            </button>
                        </div>
                        <form id="create-event-form">
                            <div class="form-group">
                                <label for="event-title">Event Title</label>
                                <input type="text" id="event-title" required>
                            </div>
                            <div class="form-group">
                                <label for="event-club">Select Club</label>
                                <select id="event-club" required>
                                    <option value="">Select Club</option>
                                    <!-- Populated by JavaScript -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="event-description">Description</label>
                                <textarea id="event-description" rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="event-date">Date & Time</label>
                                <input type="datetime-local" id="event-date" required>
                            </div>
                            <div class="form-group">
                                <label for="event-type">Event Type</label>
                                <select id="event-type">
                                    <option value="meeting">Meeting</option>
                                    <option value="workshop">Workshop</option>
                                    <option value="social">Social</option>
                                    <option value="presentation">Presentation</option>
                                </select>
                            </div>
                            <div class="form-actions">
                                <button type="button" onclick="closeModal('create-event-modal')">Cancel</button>
                                <button type="submit" class="primary-btn">Create Event</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Tutoring View -->
            <div id="tutoring-view" class="view">
                <div class="view-header">
                    <h1>Peer Tutoring</h1>
                    <button id="become-tutor-btn" class="primary-btn">
                        <i data-feather="graduation-cap"></i>
                        Become a Tutor
                    </button>
                </div>

                <div class="tutoring-tabs">
                    <button class="tab-btn active" data-tab="find-tutors">Find Tutors</button>
                    <button class="tab-btn" data-tab="my-sessions">My Sessions</button>
                    <button class="tab-btn" data-tab="tutor-profile">Tutor Profile</button>
                </div>

                <div class="tutoring-content">
                    <div id="find-tutors-tab" class="tab-content active">
                        <div class="tutors-filters">
                            <select id="subject-filter">
                                <option value="">All Subjects</option>
                                <option value="mathematics">Mathematics</option>
                                <option value="science">Science</option>
                                <option value="english">English</option>
                                <option value="history">History</option>
                                <option value="computer-science">Computer Science</option>
                            </select>
                            <select id="rating-filter">
                                <option value="">All Ratings</option>
                                <option value="5">5 Stars</option>
                                <option value="4">4+ Stars</option>
                                <option value="3">3+ Stars</option>
                            </select>
                        </div>
                        <div id="tutors-grid" class="tutors-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <div id="my-sessions-tab" class="tab-content">
                        <div id="sessions-list" class="sessions-list">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <div id="tutor-profile-tab" class="tab-content">
                        <div id="tutor-profile-content">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Become Tutor Modal -->
                <div id="become-tutor-modal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>Become a Tutor</h2>
                            <button class="close-btn" onclick="closeModal('become-tutor-modal')">
                                <i data-feather="x"></i>
                            </button>
                        </div>
                        <form id="become-tutor-form">
                            <div class="form-group">
                                <label>Subjects You Can Tutor</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" value="mathematics"> Mathematics</label>
                                    <label><input type="checkbox" value="science"> Science</label>
                                    <label><input type="checkbox" value="english"> English</label>
                                    <label><input type="checkbox" value="history"> History</label>
                                    <label><input type="checkbox" value="computer-science"> Computer Science</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="tutor-bio">Bio</label>
                                <textarea id="tutor-bio" rows="4" placeholder="Tell students about your experience and teaching style"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="hourly-rate">Hourly Rate ($)</label>
                                <input type="number" id="hourly-rate" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Available Times</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" value="morning"> Morning (6AM-12PM)</label>
                                    <label><input type="checkbox" value="afternoon"> Afternoon (12PM-6PM)</label>
                                    <label><input type="checkbox" value="evening"> Evening (6PM-10PM)</label>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" onclick="closeModal('become-tutor-modal')">Cancel</button>
                                <button type="submit" class="primary-btn">Register as Tutor</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Book Session Modal -->
                <div id="book-session-modal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>Book Tutoring Session</h2>
                            <button class="close-btn" onclick="closeModal('book-session-modal')">
                                <i data-feather="x"></i>
                            </button>
                        </div>
                        <form id="book-session-form">
                            <div class="tutor-info" id="selected-tutor-info">
                                <!-- Populated by JavaScript -->
                            </div>
                            <div class="form-group">
                                <label for="session-subject">Subject</label>
                                <select id="session-subject" required>
                                    <!-- Populated by JavaScript -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="session-date">Date & Time</label>
                                <input type="datetime-local" id="session-date" required>
                            </div>
                            <div class="form-group">
                                <label for="session-duration">Duration</label>
                                <select id="session-duration">
                                    <option value="30">30 minutes</option>
                                    <option value="60" selected>1 hour</option>
                                    <option value="90">1.5 hours</option>
                                    <option value="120">2 hours</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="session-notes">Notes (Optional)</label>
                                <textarea id="session-notes" rows="3" placeholder="Any specific topics or questions you'd like to focus on"></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="button" onclick="closeModal('book-session-modal')">Cancel</button>
                                <button type="submit" class="primary-btn">Book Session</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="firebase-config.js"></script>
    <script src="auth.js"></script>
    <script src="webrtc.js"></script>
    <script src="study-rooms.js"></script>
    <script src="matching.js"></script>
    <script src="clubs.js"></script>
    <script src="tutoring.js"></script>
    <script src="dashboard.js"></script>
    <script src="app.js"></script>
</body>
</html>
